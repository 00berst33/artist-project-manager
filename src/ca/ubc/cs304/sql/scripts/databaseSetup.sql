-- Statements to create tables
CREATE TABLE Creator_Ranks
(
    numDrafts INTEGER PRIMARY KEY,
    userRank  VARCHAR(40)
);

CREATE TABLE Creators
(
    username  VARCHAR(40) PRIMARY KEY,
    email     VARCHAR(40),
    password  VARCHAR(40),
    numDrafts INTEGER,
    UNIQUE (email),
    FOREIGN KEY (numDrafts) REFERENCES Creator_Ranks (numDrafts)
);

CREATE TABLE Works
(
    wID       INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    workName VARCHAR(20),
    createdAt DATE
);

CREATE TABLE Images
(
    wID          INTEGER PRIMARY KEY,
    canvasWidth  INTEGER,
    canvasHeight INTEGER,
    CONSTRAINT fk_image_wrk FOREIGN KEY (wID)
        REFERENCES Works (wID)
            ON DELETE CASCADE
);

CREATE TABLE Texts
(
    wID       INTEGER PRIMARY KEY,
    wordCount INTEGER,
    CONSTRAINT fk_text_wrk FOREIGN KEY (wID)
        REFERENCES Works (wID)
            ON DELETE CASCADE
);

CREATE TABLE Audios
(
    wID      INTEGER PRIMARY KEY,
    duration FLOAT,
    CONSTRAINT fk_audio_wrk FOREIGN KEY (wID)
        REFERENCES Works (wID)
            ON DELETE CASCADE
);

CREATE TABLE Groups
(
    gID       INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name      VARCHAR(40),
    statement VARCHAR(140)
);

CREATE TABLE Projects
(
    pID         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    title       VARCHAR(40),
    description VARCHAR(280),
    gID         INTEGER,
    FOREIGN KEY (gID) REFERENCES Groups
);

CREATE TABLE Branches
(
    bID             INTEGER,
    pID             INTEGER,
    wID             INTEGER,
    branchName      VARCHAR(40),
    branchCreatedAt DATE,
    username        VARCHAR(40),
    PRIMARY KEY (bID, pID),
    CONSTRAINT fk_branch_user FOREIGN KEY (username)
        REFERENCES Creators (username),
    CONSTRAINT fk_branch_pID FOREIGN KEY (pID)
        REFERENCES Projects (pID),
    CONSTRAINT fk_branch_wID FOREIGN KEY (wID)
        REFERENCES Works (wID)
);

CREATE TABLE Drafts
(
    dID       INTEGER PRIMARY KEY,
    createdAt DATE,
    username  VARCHAR(40) NOT NULL,
    bID       INTEGER,
    pID       INTEGER,

    CONSTRAINT fk_draft_user FOREIGN KEY (username)
        REFERENCES Creators (username),
    CONSTRAINT fk_draft_branch FOREIGN KEY (bID, pID)
        REFERENCES Branches (bID, pID)
            ON DELETE CASCADE
);

CREATE TABLE Comments
(
    commentID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    text      VARCHAR(280),
    username  VARCHAR(40) NOT NULL,
    createdAt DATE,
    dID       INTEGER,
    FOREIGN KEY (username) REFERENCES Creators,
    FOREIGN KEY (dID) REFERENCES Drafts
        ON DELETE CASCADE
);

CREATE TABLE Reply_to
(
    commentID INTEGER NOT NULL,
    replyID   INTEGER,
    createdAt DATE,
    username  VARCHAR(40),
    text      VARCHAR(280),
    PRIMARY KEY (commentID, replyID),
    FOREIGN KEY (commentID) REFERENCES Comments
        ON DELETE CASCADE
);

CREATE TABLE Joins
(
    Username VARCHAR(40),
    gID      INTEGER,
    PRIMARY KEY (username, gID),
    FOREIGN KEY (username) REFERENCES Creators,
    FOREIGN KEY (gID) REFERENCES Groups
);

CREATE TABLE Manages
(
    username VARCHAR(40),
    pID      INTEGER,
    PRIMARY KEY (username, pID),
    FOREIGN KEY (username) REFERENCES Creators,
    FOREIGN KEY (pID) REFERENCES Projects
);

CREATE TABLE WorksInProjects
(
    wID INTEGER,
    pID INTEGER,
    PRIMARY KEY (wID, pID),
    FOREIGN KEY (wID) REFERENCES Works,
    FOREIGN KEY (pID) REFERENCES Projects
);

CREATE TABLE IsParentOf
(
    parent_bID INTEGER,
    parent_pID INTEGER,
    child_bID  INTEGER,
    child_pID  INTEGER,
    PRIMARY KEY (parent_bID, parent_pID, child_bID, child_pID),
    FOREIGN KEY (parent_bID, parent_pID) REFERENCES Branches
        ON DELETE CASCADE,
    FOREIGN KEY (child_bID, child_pID) REFERENCES Branches
        ON DELETE CASCADE
);

CREATE TABLE Displays
(
    username VARCHAR(40),
    wID      INTEGER,
    PRIMARY KEY (username, wID),
    FOREIGN KEY (username) REFERENCES Creators,
    FOREIGN KEY (wID) REFERENCES Works
);

-- Populate tables
INSERT INTO Creator_Ranks VALUES (0, 'Newbie');
INSERT INTO Creator_Ranks VALUES (3, 'Beginner');
INSERT INTO Creator_Ranks VALUES (20, 'Beginner');
INSERT INTO Creator_Ranks VALUES (34, 'Contributor');
INSERT INTO Creator_Ranks VALUES (44, 'Contributor');
INSERT INTO Creator_Ranks VALUES (47, 'Newbie');
INSERT INTO Creator_Ranks VALUES (50, 'Contributor');
INSERT INTO Creator_Ranks VALUES (55, 'Contributor');
INSERT INTO Creator_Ranks VALUES (78, 'Super Contributor');
INSERT INTO Creator_Ranks VALUES (86, 'Super Contributor');
INSERT INTO Creator_Ranks VALUES (100, 'Super Contributor');
INSERT INTO Creator_Ranks VALUES (2950, 'Ultra Contributor');


INSERT ALL
    INTO Creators VALUES ('ersta027', 'berstad@ymail.com', 'password', 50)
INTO Creators VALUES ('caoyut', 'rcao@ymaill.com', 'password2', 20)
INTO Creators VALUES ('i0z9o', 'usharif@ymail.com', 'password3', 100)
INTO Creators VALUES ('misspiggy', 'mpiggy@ymail.com', 'password4', 3)
INTO Creators VALUES ('animal', 'animal@ymail.com', 'password5', 0)
INTO Creators VALUES ('jthrnhill', 'jcharlton@ymail.com', 'password6', 44)
INTO Creators VALUES ('nthrnhill', 'nthrn@ymail.com', 'password7', 34)
INTO Creators VALUES ('benthrn', 'bmaida@ymail.com', 'password8', 78)
INTO Creators VALUES ('ethrn', 'emccann@ymail.com', 'password9', 55)
INTO Creators VALUES ('davinki', 'dvinki@ymail.com', 'password10', 2950)
INTO Creators VALUES ('mangelo', 'mangelo@ymail.com', 'password11', 86)
INTO Creators VALUES ('sirtpratch', 'tpratchett@ymail.com', 'password12', 47)
SELECT 1 FROM DUAL;
COMMIT;


INSERT INTO Groups (name, statement) VALUES ('CPSC304 Gang', 'ummmm uhhhh huh');
INSERT INTO Groups (name, statement) VALUES ('The Muppets', 'manamana');
INSERT INTO Groups (name, statement) VALUES ('Thornhill', 'cuz im blessed with it');
INSERT INTO Groups (name, statement) VALUES ('Old Guys', 'we are old');
INSERT INTO Groups (name, statement) VALUES ('Thornhill and Bella', 'bella is here now for some reason');


INSERT INTO Joins (Username, gID) VALUES ('ersta027', 1); -- CPSC 304
INSERT INTO Joins (Username, gID) VALUES ('caoyut', 1);
INSERT INTO Joins (Username, gID) VALUES ('i0z9o', 1);
INSERT INTO Joins (Username, gID) VALUES ('misspiggy', 2); -- Muppets
INSERT INTO Joins (Username, gID) VALUES ('animal', 2);
INSERT INTO Joins (Username, gID) VALUES ('jthrnhill', 3); -- Thornhill
INSERT INTO Joins (Username, gID) VALUES ('nthrnhill', 3);
INSERT INTO Joins (Username, gID) VALUES ('benthrn', 3);
INSERT INTO Joins (Username, gID) VALUES ('ethrn', 3);
INSERT INTO Joins (Username, gID) VALUES ('davinki', 4); -- Old Guys
INSERT INTO Joins (Username, gID) VALUES ('mangelo',4);
INSERT INTO Joins (Username, gID) VALUES ('jthrnhill', 5); -- Thornhill + Bella
INSERT INTO Joins (Username, gID) VALUES ('nthrnhill', 5);
INSERT INTO Joins (Username, gID) VALUES ('benthrn', 5);
INSERT INTO Joins (Username, gID) VALUES ('ethrn', 5);
INSERT INTO Joins (Username, gID) VALUES ('ersta027', 5);


INSERT INTO Projects (title, description, gID) VALUES ('Disney Princess Project', 'we love disney princesses', 1);
INSERT INTO Projects (title, description, gID) VALUES ('Animals', 'everyone add your favorite animal', 2);
INSERT INTO Projects (title, description, gID) VALUES ('Animals2', 'the BETTER animals project for REAL animal fans', 2);
INSERT INTO Projects (title, description, gID) VALUES ('Van Goughar', 'redrawing van goghs works but all of them must include the gougar', 3);
INSERT INTO Projects (title, description, gID) VALUES ('pokemons', 'gotta catch them all!!!!!!!!!!!!!', 1);


INSERT INTO Manages (username, pID) VALUES ('ersta027',1); -- DPP
INSERT INTO Manages (username, pID) VALUES ('caoyut',1);
INSERT INTO Manages (username, pID) VALUES ('animal', 2); -- Animals
INSERT INTO Manages (username, pID) VALUES ('misspiggy',2);
INSERT INTO Manages (username, pID) VALUES ('caoyut',2);
INSERT INTO Manages (username, pID) VALUES ('nthrnhill', 3); -- Animals2
INSERT INTO Manages (username, pID) VALUES ('jthrnhill', 3);
INSERT INTO Manages (username, pID) VALUES ('animal', 3);
INSERT INTO Manages (username, pID) VALUES ('ersta027',3);
INSERT INTO Manages (username, pID) VALUES ('davinki', 4); -- Van Goughar
INSERT INTO Manages (username, pID) VALUES ('mangelo', 4);
INSERT INTO Manages (username, pID) VALUES ('ethrn', 5); -- pokemons
INSERT INTO Manages (username, pID) VALUES ('i0z9o', 5);
INSERT INTO Manages (username, pID) VALUES ('benthrn', 5);


INSERT INTO Works(workName, createdAt) VALUES ('work1', DATE '2020-01-01');
INSERT INTO Works(workName, createdAt) VALUES ('work2',DATE '2020-01-02');
INSERT INTO Works(workName, createdAt) VALUES ('work3',DATE '2020-01-03');
INSERT INTO Works(workName, createdAt) VALUES ('work4',DATE '2020-01-04');
INSERT INTO Works(workName, createdAt) VALUES ('work5',DATE '2020-01-05');
INSERT INTO Works(workName, createdAt) VALUES ('work6',DATE '2020-01-06');
INSERT INTO Works(workName, createdAt) VALUES ('work7',DATE '2020-01-07');
INSERT INTO Works(workName, createdAt) VALUES ('work8',DATE '2020-01-08');
INSERT INTO Works(workName, createdAt) VALUES ('work9',DATE '2020-01-09');
INSERT INTO Works(workName, createdAt) VALUES ('work0',DATE '2020-01-10');
INSERT INTO Works(workName, createdAt) VALUES ('work10',DATE '2020-01-11');
INSERT INTO Works(workName, createdAt) VALUES ('work11',DATE '2020-01-12');
INSERT INTO Works(workName, createdAt) VALUES ('work12',DATE '2020-01-13');
INSERT INTO Works(workName, createdAt) VALUES ('work12',DATE '2020-01-14');
INSERT INTO Works(workName, createdAt) VALUES ('work13',DATE '2020-01-15');


INSERT INTO WorksInProjects (wID, pID) VALUES (1, 1);
INSERT INTO WorksInProjects (wID, pID) VALUES (2, 2);
INSERT INTO WorksInProjects (wID, pID) VALUES (3, 3);
INSERT INTO WorksInProjects (wID, pID) VALUES (4, 4);
INSERT INTO WorksInProjects (wID, pID) VALUES (5, 5);
INSERT INTO WorksInProjects (wID, pID) VALUES (6, 1);
INSERT INTO WorksInProjects (wID, pID) VALUES (7, 3);
INSERT INTO WorksInProjects (wID, pID) VALUES (8, 2);
INSERT INTO WorksInProjects (wID, pID) VALUES (9, 4);
INSERT INTO WorksInProjects (wID, pID) VALUES (10,5);
INSERT INTO WorksInProjects (wID, pID) VALUES (11, 2);
INSERT INTO WorksInProjects (wID, pID) VALUES (12, 1);
INSERT INTO WorksInProjects (wID, pID) VALUES (13, 4);
INSERT INTO WorksInProjects (wID, pID) VALUES (14, 3);
INSERT INTO WorksInProjects (wID, pID) VALUES (15, 5);


INSERT INTO Displays (username, wID) VALUES ('ersta027', 1);
INSERT INTO Displays (username, wID) VALUES ('caoyut', 2);
INSERT INTO Displays (username, wID) VALUES ('animal', 3);
INSERT INTO Displays (username, wID) VALUES ('davinki', 4);
INSERT INTO Displays (username, wID) VALUES ('benthrn', 5);

INSERT INTO Images (wID, canvasWidth, canvasHeight) VALUES (1, 780, 360);
INSERT INTO Images (wID, canvasWidth, canvasHeight) VALUES (2, 780, 360);
INSERT INTO Images (wID, canvasWidth, canvasHeight) VALUES (3, 1080, 760);
INSERT INTO Images (wID, canvasWidth, canvasHeight) VALUES (4, 4340, 3500);
INSERT INTO Images (wID, canvasWidth, canvasHeight) VALUES (5, 360, 780);

INSERT INTO Texts (wID, wordCount) VALUES (6, 345);
INSERT INTO Texts (wID, wordCount) VALUES (7, 4300);
INSERT INTO Texts (wID, wordCount) VALUES (8, 7843);
INSERT INTO Texts (wID, wordCount) VALUES (9, 2999);
INSERT INTO Texts (wID, wordCount) VALUES (10, 60000);

INSERT INTO Audios (wID, duration) VALUES (11, 300.01);
INSERT INTO Audios (wID, duration) VALUES (12, 60.0);
INSERT INTO Audios (wID, duration) VALUES (13, 909.32);
INSERT INTO Audios (wID, duration) VALUES (14, 29.4);
INSERT INTO Audios (wID, duration) VALUES (15, 502.0);

INSERT INTO Branches (bID, wID, pID, branchName, branchCreatedAt, username) VALUES (1, 1, 1, 'chapter 1', DATE '2025-07-13', 'misspiggy');
INSERT INTO Branches (bID, wID, pID, branchName, branchCreatedAt, username) VALUES (2, 1, 1, 'chapter 2', DATE '2025-07-13', 'misspiggy');
INSERT INTO Branches (bID, wID, pID, branchName, branchCreatedAt, username) VALUES (3, 2, 1, 'chapter 2 edit', DATE '2025-07-14', 'caoyut');
INSERT INTO Branches (bID, wID, pID, branchName, branchCreatedAt, username) VALUES (4, 3, 3, 'my awesome song', DATE '2025-06-22', 'i0z9o');
INSERT INTO Branches (bID, wID, pID, branchName, branchCreatedAt, username) VALUES (5, 2, 1, 'my epic drawing', DATE '2025-07-16', 'ersta027');

INSERT INTO IsParentOf (parent_bID, parent_pID, child_bID, child_pID) VALUES (2, 1, 3, 1);

INSERT INTO Drafts (dID, createdAt, username, bID, pID) VALUES (1, DATE '2025-07-13', 'misspiggy', 1, 1);
INSERT INTO Drafts (dID, createdAt, username, bID, pID) VALUES (2, DATE '2025-07-13', 'misspiggy', 2, 1);
INSERT INTO Drafts (dID, createdAt, username, bID, pID) VALUES (3, DATE '2025-07-13', 'caoyut', 3, 1);
INSERT INTO Drafts (dID, createdAt, username, bID, pID) VALUES (4, DATE '2025-06-22', 'i0z9o', 4, 3);
INSERT INTO Drafts (dID, createdAt, username, bID, pID) VALUES (5, DATE '2025-07-16', 'ersta027', 5, 1);
INSERT INTO Drafts (dID, createdAt, username, bID, pID) VALUES (6, DATE '2025-08-01', 'misspiggy', 1, 1);


INSERT INTO Comments (text, username, createdAt, dID) VALUES ('I REALLY like this version! it turned out great!', 'caoyut', DATE '2025-07-14', 1);
INSERT INTO Comments (text, username, createdAt, dID) VALUES ('this is fantastic', 'ersta027', DATE '2025-07-13', 2);
INSERT INTO Comments (text, username, createdAt, dID) VALUES ('I AM ANIMAL', 'animal', DATE '2025-06-15', 3);
INSERT INTO Comments (text, username, createdAt, dID) VALUES ('I AM ANIMAL', 'animal', DATE '2025-06-15', 2);
INSERT INTO Comments (text, username, createdAt, dID) VALUES ('I AM ANIMAL', 'animal', DATE '2025-06-16', 2);
INSERT INTO Comments (text, username, createdAt, dID) VALUES ('This sounds great!', 'i0z9o', DATE '2025-07-13', 4);
INSERT INTO Comments (text, username, createdAt, dID) VALUES ('I AM ANIMAL', 'animal', DATE '2025-08-01', 6);
INSERT INTO Comments (text, username, createdAt, dID) VALUES ('Love it!', 'caoyut', DATE '2025-08-01', 6);
INSERT INTO Comments (text, username, createdAt, dID) VALUES ('Animal please stop', 'ersta027', DATE '2025-08-01', 6);
INSERT INTO Comments (text, username, createdAt, dID) VALUES ('The best draft yet!', 'i0z9o', DATE '2025-08-01', 6);


INSERT INTO Reply_to (commentID, replyID, createdAt, username, text) VALUES (3, 1, DATE '2025-06-17', 'caoyut', 'animal stop spamming');
INSERT INTO Reply_to (commentID, replyID, createdAt, username, text) VALUES (3, 2, DATE '2025-06-17', 'caoyut', 'can someone report animal');
INSERT INTO Reply_to (commentID, replyID, createdAt, username, text) VALUES (3, 3, DATE '2025-06-18', 'caoyut', 'can devs implement a reporting function smh');
INSERT INTO Reply_to (commentID, replyID, createdAt, username, text) VALUES (5, 1, DATE '2025-06-17', 'misspiggy', 'Thank you caoyut. I painted this with my toe');
INSERT INTO Reply_to (commentID, replyID, createdAt, username, text) VALUES (6, 1, DATE '2025-06-18', 'animal', 'I AM ANIMAL');

COMMIT;
